% spell-checker:disable
\PassOptionsToPackage{table,svgnames,dvipsnames}{xcolor}

\pdfminorversion=7 % changed pdf version, because embeded documents need newer features

\usepackage[utf8]{inputenc} % inputenc package ignored with utf8 based engines
\usepackage[T1]{fontenc}
\usepackage[sc]{mathpazo}
\usepackage[ngerman,american]{babel}
\usepackage[autostyle]{csquotes}

\usepackage[%
  backend=biber,
  url=false,
  style=alphabetic,
  maxnames=3,
  minnames=3,
  maxbibnames=99,
  giveninits,
  uniquename=init]{biblatex}
\setcounter{biburlnumpenalty}{7000} % break urls in bibliography https://texwelt.de/wissen/fragen/7008/zeilenumbruche-in-bibliografielinks
\usepackage{url}
\usepackage[hidelinks,breaklinks]{hyperref} % hidelinks removes colored boxes around references and links
\usepackage{textcomp} % for good looking copyright and registered symbols and arrows and more symbols
\usepackage{scrhack} % necessary for listings package
\usepackage{listings} % code highlighting
\usepackage{lstautogobble}
% \usepackage{graphicx} % draw graphics
\usepackage{tikz} % draw graphics, will load graphicx
\usetikzlibrary{fit, positioning, shapes}
\usepackage{pgf} % use pgf maths
\usepackage{pgfplots} % plots with tikz
% \usepackage{pgfplotstable} % tables with pgf, we are using booktabs for this
\usepackage{booktabs} % nice tables: https://inf.ethz.ch/personal/markusp/teaching/guides/guide-tables.pdf
\usepackage{float} % require by the H-argument of figure e.g. \begin{figure}[H]
\usepackage[final]{microtype} % better font cerning: http://www.khirevich.com/latex/microtype/
\usepackage[printonlyused]{acronym} % acronyms toc and referencing
\usepackage{enumitem} % bullet lists
\usepackage[bf]{caption} % figure captions, make figure label bold
\usepackage{subcaption} % caption inside a figure with a caption
\usepackage{chngcntr} % change how figures are counted (important for figure referencing)
\counterwithin{figure}{section} % also count sections
%\counterwithin{figure}{subsection} % also count subsections
\counterwithin{table}{section} % also count sections
\usepackage{perpage} % reset counters per page
\MakePerPage{footnote} % reset footnotes each page
\interfootnotelinepenalty=10000 % prevent splitting of footnotes to the next page
\usepackage{etoolbox} % advanced scripting.. se acronyms def.
\usepackage[toc,page]{appendix} % more control over appendix
\usepackage[final]{pdfpages} % allow embedding of pdf documents
\usepackage[super]{nth} % allows to use \nth{3} to print superscriped sec_ond
\usepackage{breakcites} % push long citations into the next line

\bibliography{bibliography}

\setkomafont{disposition}{\normalfont\bfseries} % use serif font for headings
\linespread{1.05} % adjust line spread for mathpazo font
\setlength\parindent{0pt} % remove indents
\setlength\parskip{1ex} %TODO: is this legal?

% Add table of contents to PDF bookmarks
\BeforeTOCHead[toc]{{\cleardoublepage\pdfbookmark[0]{\contentsname}{toc}}}


% Define TUM corporate design colors
% Taken from http://portal.mytum.de/corporatedesign/index_print/vorlagen/index_farben
\definecolor{TUMBlue}{HTML}{0065BD}
\definecolor{TUMSecondaryBlue}{HTML}{005293}
\definecolor{TUMSecondaryBlue2}{HTML}{003359}
\definecolor{TUMBlack}{HTML}{000000}
\definecolor{TUMWhite}{HTML}{FFFFFF}
\definecolor{TUMDarkGray}{HTML}{333333}
\definecolor{TUMGray}{HTML}{808080}
\definecolor{TUMLightGray}{HTML}{CCCCC6}
\definecolor{TUMAccentGray}{HTML}{DAD7CB}
\definecolor{TUMAccentOrange}{HTML}{E37222}
\definecolor{TUMAccentGreen}{HTML}{A2AD00}
\definecolor{TUMAccentLightBlue}{HTML}{98C6EA}
\definecolor{TUMAccentBlue}{HTML}{64A0C8}

\definecolor{CustomGrey}{HTML}{fcfcfc}

% Settings for pgfplots
\pgfplotsset{compat=newest}
\pgfplotsset{
  % For available color names, see http://www.latextemplates.com/svgnames-colors
  cycle list={TUMBlue\\TUMAccentOrange\\TUMAccentGreen\\TUMSecondaryBlue2\\TUMDarkGray\\},
}

% Settings for lstlistings
\lstset{%
  basicstyle=\ttfamily\footnotesize,
  columns=fullflexible,
  autogobble,
  extendedchars=true,
  sensitive=true,
  showstringspaces=false,
  showspaces=false,
  numbers=left,
  numberstyle=\scriptsize,
  numbersep=9pt,
  tabsize=2,
  breaklines=true,
  showtabs=false,
  captionpos=b,
  backgroundcolor=\color{CustomGrey},
  keywordstyle=\color{TUMBlue}\bfseries,
  keywordstyle=[2]\color{TUMGray}\bfseries,
  identifierstyle=\color{TUMBlack},
  commentstyle=\color{TUMAccentGreen}\ttfamily,
  stringstyle=\color{TUMAccentOrange}\ttfamily,
  escapechar=\%
}

% chktex-file 18
\lstdefinelanguage{JavaScript}{
  keywords=[1]{break, case, catch, continue, debugger, default, delete, do, else, false, finally, for, function, if, in, instanceof, new, null, return, switch, this, throw, true, try, typeof, var, let, const, void, while, with},
  keywords=[2]{class, export, boolean, throw, implements, import, this},
  morecomment=[l]{//},
  morecomment=[s]{/*}{*/},
  morestring=[b]',
  morestring=[b]",
  morestring=[b]'',
}

\lstdefinelanguage{Protobuf}{
  keywords=[1]{enum, message},
  keywords=[2]{syntax, import, package},
  morecomment=[l]{//},
  morecomment=[s]{/*}{*/},
  morestring=[b]',
  morestring=[b]",
  morestring=[b]''
}

% allow multiple footnotes seperated by commas (https://tex.stackexchange.com/questions/40072/incompatibility-between-footmisc-option-multiple-and-hyperref/62091#62091)
\let\oldFootnote\footnote%
\newcommand\nextToken\relax

\renewcommand\footnote[1]{%
    \oldFootnote{#1}\futurelet\nextToken\isFootnote}

\newcommand\isFootnote{%
    \ifx\footnote\nextToken\textsuperscript{,}\fi}

    % increase distance between numbers and text in list of figures
\makeatletter
%\renewcommand*\l@figure{\@dottedtocline{1}{1.5em}{2.3em}} % original values in scrreprt
\renewcommand*\l@figure{\@dottedtocline{1}{1.5em}{3em}}% modified. 
\let\l@table\l@figure%
\makeatother

% hang caption label in caption text https://tex.stackexchange.com/questions/40163/caption-package-bold-numbering-indents-caption-text-how-to-avoid-that
\captionsetup{format=plain}
\captionsetup{width=0.9\textwidth}
